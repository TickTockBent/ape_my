# Ape_my Schema Format Specification

## Overview

Ape_my uses a simple JSON schema format to define the entities and their fields for your mock API. The schema is intuitive and focuses on the essential information needed to generate RESTful endpoints.

---

## Basic Structure

```json
{
  "entities": {
    "entityName": {
      "fields": {
        "fieldName": {
          "type": "string|number|boolean|object|array",
          "required": true|false
        }
      }
    }
  }
}
```

---

## Example Schema

```json
{
  "entities": {
    "users": {
      "fields": {
        "id": {
          "type": "string",
          "required": true
        },
        "name": {
          "type": "string",
          "required": true
        },
        "email": {
          "type": "string",
          "required": true
        },
        "age": {
          "type": "number",
          "required": false
        },
        "active": {
          "type": "boolean",
          "required": false
        }
      }
    },
    "posts": {
      "fields": {
        "id": {
          "type": "string",
          "required": true
        },
        "title": {
          "type": "string",
          "required": true
        },
        "content": {
          "type": "string",
          "required": true
        },
        "published": {
          "type": "boolean",
          "required": false
        },
        "tags": {
          "type": "array",
          "required": false
        }
      }
    }
  }
}
```

---

## Field Types

Ape_my supports the following JSON field types:

| Type | Description | Example Values |
|------|-------------|----------------|
| `string` | Text data | `"hello"`, `"user@example.com"` |
| `number` | Numeric data (int or float) | `42`, `3.14` |
| `boolean` | True/false values | `true`, `false` |
| `object` | Nested JSON object | `{"key": "value"}` |
| `array` | List of values | `[1, 2, 3]`, `["a", "b"]` |

---

## Field Properties

### `type` (required)

The JSON data type for this field. Must be one of: `string`, `number`, `boolean`, `object`, `array`.

### `required` (optional, default: false)

Whether this field must be present when creating or updating an entity.

- `true`: Field must be present in POST/PUT requests
- `false`: Field is optional

**Note**: The `id` field is special and will be auto-generated by Ape_my if not provided.

---

## Generated Routes

For each entity defined in the schema, Ape_my automatically generates the following RESTful endpoints:

| Method | Endpoint | Description |
|--------|----------|-------------|
| `POST` | `/entityName` | Create a new entity |
| `GET` | `/entityName` | List all entities |
| `GET` | `/entityName/:id` | Get a specific entity by ID |
| `PUT` | `/entityName/:id` | Replace an entire entity |
| `PATCH` | `/entityName/:id` | Partially update an entity |
| `DELETE` | `/entityName/:id` | Delete an entity |

### Example

With the schema above, Ape_my would generate:

- `/users` and `/users/:id`
- `/posts` and `/posts/:id`

---

## Seed Data Format

Seed data uses a simple JSON structure matching your schema:

```json
{
  "users": [
    {
      "id": "1",
      "name": "Alice",
      "email": "alice@example.com",
      "age": 30,
      "active": true
    },
    {
      "id": "2",
      "name": "Bob",
      "email": "bob@example.com",
      "age": 25,
      "active": true
    }
  ],
  "posts": [
    {
      "id": "1",
      "title": "First Post",
      "content": "Hello world!",
      "published": true,
      "tags": ["intro", "welcome"]
    }
  ]
}
```

---

## Validation Rules

### v0.1.0 MVP

1. **Required Fields**: When `required: true`, the field must be present in POST requests
2. **Type Checking**: Basic type validation (string vs number vs boolean)
3. **ID Generation**: If `id` field is not provided, Ape_my generates a unique ID automatically

### Future Enhancements (post-MVP)

- Custom validation rules (min/max, regex patterns)
- Default values
- Field relationships (foreign keys)
- Enum types
- Format validation (email, URL, date)

---

## Complete Example

**schema.json**:
```json
{
  "entities": {
    "todos": {
      "fields": {
        "id": {
          "type": "string",
          "required": true
        },
        "task": {
          "type": "string",
          "required": true
        },
        "completed": {
          "type": "boolean",
          "required": false
        },
        "priority": {
          "type": "number",
          "required": false
        }
      }
    }
  }
}
```

**seed.json** (optional):
```json
{
  "todos": [
    {
      "id": "1",
      "task": "Buy groceries",
      "completed": false,
      "priority": 2
    },
    {
      "id": "2",
      "task": "Walk the dog",
      "completed": true,
      "priority": 1
    }
  ]
}
```

**Usage**:
```bash
go ape_my schema.json with seed.json on 3000
```

This will start a server on port 3000 with:
- `/todos` endpoints (POST, GET, PUT, PATCH, DELETE)
- Pre-populated with 2 todo items from seed.json
